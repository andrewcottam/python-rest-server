#!/usr/bin/env python
import web, os, subprocess
urls = (
  "/", "callMarxan"
  )

class callMarxan:
    def GET(self):
        try:
            web.header('Content-Type','text/html') 
            os.chdir("/home/ubuntu/workspace/marxan/Marxan243/MarxanData_unix") # so files can be found in the input.dat file
            p = subprocess.Popen(["/home/ubuntu/workspace/marxan/Marxan243/MarxanData_unix/MarOpt_v243_Linux64"], stdout=subprocess.PIPE) 
            out, err = p.communicate()
        except subprocess.CalledProcessError as e:
            return "Marxan return code: " + str(e.returncode)
        return out

app = web.application(urls, locals()) 

if __name__ == "__main__":
    app.run()